<!doctype html><html><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Reset Password</title>
</head><body class="bg-neutral-900 text-neutral-100 flex justify-center items-center h-screen">
  <div class="w-full max-w-sm">
    <h1 class="text-xl mb-4 text-center">Set a New Access Code</h1>
    <form id="reset-form" class="space-y-3">
      <input id="new-password" type="password" minlength="8" placeholder="New password"
             class="w-full p-2 rounded bg-neutral-800 border border-neutral-600 text-neutral-200" required>
      <button type="submit"
              class="w-full bg-orange-600 hover:bg-orange-500 text-white font-medium py-2 px-4 rounded">
        Update
      </button>
    </form>
    <p id="reset-msg" class="text-sm mt-3"></p>
  </div>

  <script type="module">
    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'
    const supabase = createClient('https://YOUR_PROJECT_REF.supabase.co','PUBLIC_ANON_KEY')

    const form = document.getElementById('reset-form')
    const msg  = document.getElementById('reset-msg')

    form.addEventListener('submit', async (e) => {
      e.preventDefault()
      const newPassword = document.getElementById('new-password').value
      const { data: { session } } = await supabase.auth.getSession()
      if (!session) {
        msg.textContent = 'This link is invalid or expired. Request a new reset email.'
        return
      }

      const { error } = await supabase.auth.updateUser({ password: newPassword })
      msg.textContent = error ? `Error: ${error.message}` : 'Password updated. You can close this tab and sign in.'
    })
  </script>
</body></html>
