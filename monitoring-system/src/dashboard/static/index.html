<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipeline Monitoring Dashboard</title>
    <link rel="stylesheet" href="/static/dashboard.css">
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <h1>Pipeline Monitoring Dashboard</h1>
                <div class="connection-status">
                    <span id="connection-indicator" class="status-indicator disconnected"></span>
                    <span id="connection-text">Connecting...</span>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <main class="dashboard-main">
            <!-- System Status Overview -->
            <section class="status-overview">
                <div class="status-layout">
                    <div class="status-cards">
                        <div class="status-card">
                            <h3>Pipeline Status</h3>
                            <div id="pipeline-status" class="status-value">Loading...</div>
                        </div>
                        <div class="status-card">
                            <h3>Active Runs</h3>
                            <div id="active-runs" class="status-value">0</div>
                        </div>
                        <div class="status-card">
                            <h3>Success Rate</h3>
                            <div id="success-rate" class="status-value">0%</div>
                        </div>
                        <div class="status-card">
                            <h3>Avg Duration</h3>
                            <div id="avg-duration" class="status-value">0s</div>
                        </div>
                    </div>
                    <div class="status-visualization">
                        <div class="visual-card">
                            <div class="visual-card-header">
                                <h3>Run Distribution</h3>
                                <span class="visual-caption">Last 25 runs</span>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="pipeline-status-chart"></canvas>
                                <div class="chart-center">
                                    <span id="pipeline-total" class="chart-total">0</span>
                                    <span class="chart-subtitle">Total Runs</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="visual-grid">
                <div class="visual-card">
                    <div class="visual-card-header">
                        <h2>Webhook Flow Health</h2>
                        <span class="visual-caption">Source to destination throughput</span>
                    </div>
                    <div class="chart-wrapper large">
                        <canvas id="webhook-flow-chart"></canvas>
                    </div>
                </div>
                <div class="visual-card">
                    <div class="visual-card-header">
                        <h2>Performance Trends</h2>
                        <span class="visual-caption">Key metrics over time</span>
                    </div>
                    <div class="chart-wrapper large">
                        <canvas id="performance-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Real-time Pipeline Runs -->
            <section class="pipeline-runs">
                <h2>Recent Pipeline Runs</h2>
                <div class="runs-controls">
                    <button id="refresh-runs" class="btn btn-primary">Refresh</button>
                    <select id="status-filter">
                        <option value="">All Statuses</option>
                        <option value="running">Running</option>
                        <option value="completed">Completed</option>
                        <option value="failed">Failed</option>
                    </select>
                </div>
                <div id="runs-container" class="runs-list">
                    <div class="loading">Loading pipeline runs...</div>
                </div>
            </section>

            <!-- Alerts Section -->
            <section class="alerts-section">
                <h2>Active Alerts</h2>
                <div id="alerts-container" class="alerts-list">
                    <div class="no-alerts">No active alerts</div>
                </div>
            </section>

            <!-- Performance Metrics -->
            <section class="metrics-section">
                <h2>Performance Metrics</h2>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <h3>Webhook Latency</h3>
                        <div id="webhook-latency" class="metric-value">0ms</div>
                        <div class="metric-trend" id="webhook-trend"></div>
                    </div>
                    <div class="metric-card">
                        <h3>Build Time</h3>
                        <div id="build-time" class="metric-value">0s</div>
                        <div class="metric-trend" id="build-trend"></div>
                    </div>
                    <div class="metric-card">
                        <h3>Deploy Time</h3>
                        <div id="deploy-time" class="metric-value">0s</div>
                        <div class="metric-trend" id="deploy-trend"></div>
                    </div>
                    <div class="metric-card">
                        <h3>Site Response</h3>
                        <div id="site-response" class="metric-value">0ms</div>
                        <div class="metric-trend" id="site-trend"></div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Real-time Activity Feed -->
        <aside class="activity-feed">
            <h3>Live Activity</h3>
            <div id="activity-container" class="activity-list">
                <div class="activity-item">
                    <span class="activity-time">--:--:--</span>
                    <span class="activity-message">Waiting for activity...</span>
                </div>
            </div>
        </aside>
    </div>

    <!-- Modal for Pipeline Run Details -->
    <div id="run-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Pipeline Run Details</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div id="run-details-content">
                    Loading...
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js" integrity="sha384-W4aNFYntE5Vmmyr3ZreMw7kmr+H4lWlHUNZPam53ALDH3AEst9Lh+dYt1bAO+CWr" crossorigin="anonymous"></script>
    <script type="module" src="/static/dashboard.js"></script>
</body>
</html>
