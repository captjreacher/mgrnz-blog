(()=>{"use strict";var e={557:(e,t,o)=>{o.d(t,{Z:()=>i});var r=o(196),a=o(609);const s=window.wp.i18n,n=window.wp.element,l=window.wp.url;class c extends n.Component{constructor(e){super(e),this.state={shortcode:"",response:{},form_id:this.props.sharedInstanceId}}updateFormData(){const{shortcode:e}=this.props,t=new URL(window.location.href),o=(0,l.addQueryArgs)(wpApiSettings.root+"emailoctopus/v1/preview-shortcode",{shortcode:e,_wpnonce:wpApiSettings.nonce,postId:t.searchParams.get("post")});window.fetch(o,{credentials:"include"}).then((e=>{e.json().then((t=>({data:t,status:e.status}))).then((e=>{200===e.status&&this.setState({response:e})})).catch((()=>{const e={data:{html:(0,s.__)("A server error occurred.","emailoctopus"),js:"",style:""}};this.setState({response:e,form_id:this.props.sharedInstanceId})}))}))}componentDidMount(){this.updateFormData()}render(){this.state.form_id!==this.props.sharedInstanceId&&(this.setState({response:!1}),this.setState({form_id:this.props.sharedInstanceId}),this.updateFormData());const{parentSelected:e,sharedInstanceId:t}=this.props,o=this.state.response;if(o.isLoading||!o.data)return(0,r.createElement)("div",{className:"wp-block-embed is-loading"},(0,r.createElement)(a.Spinner,null));const n=o.data.style+" "+o.data.html+" "+o.data.js,l=[(0,r.createElement)(a.SandBox,{html:n,title:(0,s.__)("EmailOctopus Form Preview","emailoctopus"),type:"embed",key:`cd2-shortcode-block-preview-${t}`})];return e||l.push((0,r.createElement)("div",{className:"sandbox-preview-overlay",key:`cd2-shortcode-block-preview-interaction-blocker-${t}`})),l}}const i=c},196:e=>{e.exports=window.React},609:e=>{e.exports=window.wp.components}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=o(196),t=o(609);const r=window.wp.blockEditor;var a;function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},s.apply(this,arguments)}var n=function(t){return e.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 89 117"},t),a||(a=e.createElement("path",{fill:"#000",fillRule:"nonzero",d:"M86.723 74.579c-2.989-1.551-6.278.25-7.589 1.573a7.587 7.587 0 0 1-2.806 1.802 7.786 7.786 0 0 1-3.311.456 7.905 7.905 0 0 1-3.197-.98c-.989-.548-1.817-1.323-2.484-2.236a7.323 7.323 0 0 1-.436-.707c10.118-7.572 16.627-19.614 16.604-33.161C83.481 18.428 64.577-.16 41.487-.002 18.536.159 0 18.656 0 41.44c0 14.825 7.865 27.847 19.663 35.168-.046.365-.115.73-.207 1.095a7.597 7.597 0 0 1-1.518 2.965 7.448 7.448 0 0 1-2.645 2.03 7.942 7.942 0 0 1-.782.319c-.023 0-.023 0-.046.023-.092.023-.16.046-.253.068a7.976 7.976 0 0 1-3.288.228c-1.84-.273-6.83-.456-8.164 2.92-1.22 3.101 1.334 5.473 3.978 6.294.483.16.966.274 1.472.388.368.114.736.205 1.104.251.897.137 1.817.205 2.737.205 1.701 0 3.38-.251 4.99-.73.023 0 .023 0 .046-.022.023 0 .023 0 .046-.023.23-.069.483-.137.713-.228a17.84 17.84 0 0 0 5.98-3.467c.39-.342.735-.707 1.08-1.117.253-.274.483-.525.736-.821.115-.137.207-.274.322-.411.023-.023.023-.046.046-.068a16.658 16.658 0 0 0 1.426-2.144s0-.023.023-.023c.16-.297.62-.114.506.205-.023.046-.023.069-.046.114a33.142 33.142 0 0 1-4.6 9.077 34.81 34.81 0 0 1-5.634 6.113c-2.277 1.915-3.128 5.154-1.587 7.686 1.541 2.531 4.876 3.352 7.221 1.528a43.785 43.785 0 0 0 8.785-9.146 43.883 43.883 0 0 0 6.325-12.863c.115-.411.276-.981.414-1.574.092-.41.713-.342.713.069.023.524.023 1.049.023 1.551a33.33 33.33 0 0 1-2.967 13.228 33.872 33.872 0 0 1-4.347 7.07c-1.862 2.303-2.046 5.656-.046 7.845 2.001 2.19 5.428 2.372 7.383.137a44.002 44.002 0 0 0 6.853-10.651 43.223 43.223 0 0 0 3.91-17.47v-1.368c0-.32.46-.388.551-.091.138.501.276.98.368 1.322a33.03 33.03 0 0 1 .736 10.309 32.432 32.432 0 0 1-1.748 8.097c-.989 2.782-.046 6.021 2.576 7.412s5.91.433 6.991-2.304a43.38 43.38 0 0 0 2.898-12.293c.322-3.626.16-7.252-.414-10.81-.161-1.049-.391-2.076-.62-3.102-.07-.251.252-.456.459-.274a18.074 18.074 0 0 0 2.668 1.871 17.767 17.767 0 0 0 7.359 2.258c2.599.205 5.197-.16 7.635-1.05a17.776 17.776 0 0 0 6.462-4.173 17.18 17.18 0 0 0 1.771-2.099c1.633-2.166 1.127-5.108-1.334-6.385M26.999 47.78c-2.852.388-5.496-1.573-5.887-4.424a5.167 5.167 0 0 1 4.461-5.839c2.852-.388 5.497 1.574 5.887 4.425.391 2.828-1.586 5.45-4.461 5.838m37.187-5.131c-2.852.387-5.497-1.574-5.888-4.425-.39-2.828 1.587-5.45 4.462-5.838 2.852-.388 5.496 1.573 5.887 4.424.391 2.851-1.61 5.451-4.461 5.839"})))};const l=JSON.parse('{"TN":"EmailOctopus Form"}');var c=o(557);const i=()=>(0,e.createElement)(t.Icon,{icon:n,className:"emailoctopus-block-icon"});wp.blocks.registerBlockType("emailoctopus/form-block",{icon:i,edit:o=>{const a=e=>new Option(e).innerHTML;let s="",n="",m="",d="",p="",u={icon:i,label:l.TN};if(emailoctopus_form.is_connected){if(o.attributes.form_id){if(emailoctopus_form.forms.length)for(let e of emailoctopus_form.forms)o.attributes.form_id===e.value&&(m=e.name,d=e.type,p=e.type_friendly);["bar","slide-in","modal"].includes(d)?s=(0,e.createElement)("div",null,(0,e.createElement)("strong",null,emailoctopus_form.labels.preview_form_selection.replace("%1$s",a(m)).replace("%2$s",a(p))),(0,e.createElement)("br",null),emailoctopus_form.labels.preview_form_view):d?(u={},s=(0,e.createElement)(c.Z,{shortcode:'[emailoctopus form_id="'+a(o.attributes.form_id)+'"]',parentSelected:o.isSelected,sharedInstanceId:a(o.attributes.form_id)})):s=(0,e.createElement)("div",null,emailoctopus_form.labels.error_form_not_found.replace("%s",a(o.attributes.form_id)))}else s=(0,e.createElement)("div",null,emailoctopus_form.labels.add_form);emailoctopus_form.forms.length<=1?n=(0,e.createElement)("div",{dangerouslySetInnerHTML:{__html:emailoctopus_form.labels.no_forms}}):"not-found"!==d&&o.attributes.form_id&&(n=(0,e.createElement)("div",null,(0,e.createElement)("a",{target:"_blank",href:emailoctopus_form.form_url_base+"&form-id="+o.attributes.form_id},emailoctopus_form.labels.display_settings),(0,e.createElement)("br",null),(0,e.createElement)("a",{target:"_blank",rel:"noopener",href:"https://emailoctopus.com/forms/embedded/"+o.attributes.form_id+"/design"},emailoctopus_form.labels.view_on)))}else s=(0,e.createElement)("div",{dangerouslySetInnerHTML:{__html:emailoctopus_form.labels.api_connection_required}});return(0,e.createElement)("div",{...(0,r.useBlockProps)(),"data-form-type":d},(0,e.createElement)(t.Placeholder,{...u},s),emailoctopus_form.is_connected&&(0,e.createElement)(r.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:emailoctopus_form.labels.tab_label,initialOpen:!0},emailoctopus_form.forms.length>0&&(0,e.createElement)(t.PanelRow,null,(0,e.createElement)(t.SelectControl,{label:emailoctopus_form.labels.select_label,value:a(o.attributes.form_id),options:emailoctopus_form.forms,onChange:e=>(e=>{o.setAttributes({form_id:e})})(e),__nextHasNoMarginBottom:!0})),(0,e.createElement)(t.PanelRow,null,n))))},save:()=>null})})()})();